language: node_js
node_js:
    - 13
cache:
    directories:
        - dist/components
        - dist/doc-lib
        - dist/examples
stages:
    - prepare
    - build-components-lib
    - build-doc-lib
    - build-app-aot
    - test
    - name: publish
      if: branch = master
    - deploy
jobs:
    include:
        #        - stage: prepare
        #          name: Lint /components
        #          script: npm run lint components
        #        - stage: prepare
        #          name: Lint /doc-lib
        #          script: npm run lint doc-lib
        #        - stage: prepare
        #          name: Lint /examples
        #          script: npm run lint examples

        - stage: build-components-lib
          name: Build /components
          script: npm run build:components

        #        - stage: build-doc-lib
        #          name: Build /doc-lib
        #          script: npm run build:doc-lib

        #        - stage: build-app-aot
        #          name: Build /examples
        #          before_script:
        #              - cd ./projects/doc-lib
        #              - npm install
        #              - npm link
        #              - cd ../../
        #              - npm run build-components-doc
        #              - npm run build-examples-doc
        #          script:
        #              npm run build:examples-aot

        #        - stage: test
        #          name: Unit tests for /components
        #          script: npm run test:ci:components
        #        - stage: test
        #          name: Unit Tests for /doc-lib
        #          script: npm run test:ci:doc-lib

        - stage: publish
          name: Publishing components to npm registry
          script: echo "Deploying to npm user psimhadri..."
          deploy:
              provider: npm
              email: prudhvi.af121@gmail.com
              api_key:
                  secure: eBl4hoXKJ9iFuiOr6KyuH3uGTjexJBz7zJenlRubeDjXS9vfkZkirktF+qdyk8YFWv7dgOlqwuMlkPc3ajoZ82hHAEaR1CzOejvI52ku+BF2Ry/vmcMNxEvX8yZ+HOZZoDOuuME9Hr/0lL2hYfpMDjZTqDJ8RA7Z/bKOvpaeGKEedrHGA5JLUD5MInYLgLTByilN2atTqiFiFsU6EykeXOHlKI1xceyaNdFbYD4J1FRMC8urkLJkNqo5W6kuqIy13kz5Df4OAHnhNzkZozv0bjJSesrYWarIXcsTy2VtyyWvvDkpsOihocCOHqOjPR/XoQ89l2E/cLlypDU8yfWtkkJW0Jn3cX0VvrerSvSAXzSrMnxig8H+ErM+ALMjUWZjEOKeK9WLZGvKRBaQ9qo+mOMD194C0AY1U/si4crpBw607zEMm/HSZOwtRjf9UjDeAuaVDg7myq/9IIW9OqFY8rvjwqNma+FguBftGmEWeUmjU4u1pXChe0odNU4BigdC5TIEFON+hAo0CRbtdmE4YaoCjfPvzP0/bljFN4IkTabQMJBle+z10suB8uf8VMvM8lbaBssRUoF8QxYlcoYgNJScQgJbX3xOrN003TpMMwESCjwLMeTbK6mnwiPRwVvVpqNjVshKuG8SytPF3H0pvdBJUIwiqE8DzZZ13NIMLhc=
              on:
                  repo: ps37/vmware-cloud-director-ui-components
                  branch: travis-test-4
              local_dir: dist/components
        #        - stage: deploy
        #          name: Deploying to Github pages
        #          script: skip
        #          deploy:
        #              - provider: pages
        #                skip_cleanup: true
        #                github_token: $GH_TOKEN
        #                local_dir: dist/examples
