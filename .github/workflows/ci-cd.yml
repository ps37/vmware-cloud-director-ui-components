name: CI-CD

# Trigger the workflow on pull request
on: [pull_request]

jobs:
    cache-npm-dependencies:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v2
            - run: npm install
            - uses: actions/cache@v1
              with:
                  path: node_modules
                  key: node_modules

    lint-projects:
        runs-on: ubuntu-latest
        name: Lint /components
        needs: [cache-npm-dependencies]
        steps:
            - uses: actions/checkout@v2
            - uses: actions/cache@v1
              with:
                  path: node_modules
                  key: node_modules
            - run: |
                  npm run lint components
                  npm run lint doc-lib
                  npm run lint examples

    build-components-lib:
        runs-on: ubuntu-latest
        name: Build /components
        needs: [lint-components, lint-doc-lib, lint-examples]
        steps:
            - uses: actions/checkout@v2
            - uses: actions/cache@v1
              with:
                  path: node_modules
                  key: node_modules
            - run: npm run build:components

    build-doc-lib:
        runs-on: ubuntu-latest
        name: Build /doc-lib
        needs: [lint-components, lint-doc-lib, lint-examples]
        steps:
            - uses: actions/checkout@v2
            - uses: actions/cache@v1
              with:
                  path: node_modules
                  key: node_modules
            - run: npm run build:doc-lib

    build-app:
        runs-on: ubuntu-latest
        name: Build /examples
        needs: [build-components-lib, build-doc-lib]
        steps:
            - uses: actions/checkout@v2
            - uses: actions/cache@v1
              with:
                  path: node_modules
                  key: node_modules
            - run: npm run build:examples
