<clr-dropdown class="nested-dropdown">
    <button
        [ngClass]="{ 'btn btn-sm btn-link': dropdownTriggerBtnTxt }"
        clrDropdownTrigger
        [vcdShowClippedText]="clipTextConfig"
    >
        <ng-container *ngIf="dropdownTriggerBtnTxt">
            {{ dropdownTriggerBtnTxt | translate }}
            <clr-icon *ngIf="!isNestedDropdown" shape="caret down"></clr-icon>
        </ng-container>
        <clr-icon *ngIf="!dropdownTriggerBtnTxt" [attr.shape]="dropdownTriggerBtnIcon"></clr-icon>
    </button>

    <clr-dropdown-menu
        class="nested-dropdown-menu"
        clrPosition="{{ isNestedDropdown ? nestedDropdownPosition : dropdownPosition }}"
        *clrIfOpen
    >
        <ng-container *ngFor="let action of items; trackBy: trackByFunction">
            <ng-container *ngIf="action.children && action.children.length">
                <vcd-dropdown
                    [items]="action.children"
                    [dropdownTriggerBtnTxt]="action.textKey"
                    [nestedDropdownPosition]="nestedDropdownPosition"
                    [isNestedDropdown]="true"
                    [onItemClickedCb]="onItemClickedCb"
                    [isItemDisabledCb]="isItemDisabledCb"
                    [trackByFunction]="trackByFunction"
                    [dropdownItemContents]="dropdownItemContents"
                ></vcd-dropdown>
            </ng-container>

            <ng-container *ngIf="!action.children && (!action.availability || action.availability)">
                <button
                    class="btn btn-link"
                    [ngClass]="{ 'btn-icon': shouldShowIcon }"
                    clrDropdownItem
                    (click)="onItemClickedCb(action)"
                    [disabled]="isItemDisabledCb(action)"
                >
                    <ng-container *ngIf="shouldShowText">{{
                        action.isNotTranslatable ? action.textKey : (action.textKey | translate)
                    }}</ng-container>

                    <a *ngIf="shouldShowIcon" role="tooltip" aria-haspopup="true" class="tooltip tooltip-sm">
                        <clr-icon size="1em" [attr.shape]="action.icon"></clr-icon>
                        <span class="tooltip-content" *ngIf="shouldShowTooltip">{{ action.textKey }}</span>
                    </a>
                </button>
            </ng-container>
        </ng-container>
    </clr-dropdown-menu>
</clr-dropdown>
